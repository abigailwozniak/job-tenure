--------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\awaggone\Dropbox\Job tenure\NLS and NLSY data\NLSY97\Data construction\makedata_nlsy97.log
  log type:  text
 opened on:  12 Mar 2019, 16:01:09

. 
. *** Read in NLSY97 data for doing returns to experience estimation.
. *** Updated to add job tenure project variables to nlsy97_fall2011 data set.
. 
. qui infile using nlsy97_sp2019.dct

. qui do nlsy97_sp2019-value-labels.do

. qui do rename_nlsy97_sp2019.do

. 
. summ hgc* tenureweeks1* intmonth* hrp1*

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     hgc1997 |      8,984    7.703362    1.600695         -4         12
     hgc1998 |      8,984    8.400267     4.07454         -5         95
     hgc1999 |      8,984    8.920191    4.773622         -5         95
     hgc2000 |      8,984    9.390583    5.471028         -5         95
     hgc2001 |      8,984     9.63947    6.250559         -5         95
-------------+---------------------------------------------------------
     hgc2002 |      8,984    10.17787    6.699725         -5         95
     hgc2003 |      8,984    10.18455    6.988198         -5         95
     hgc2004 |      8,984    9.926981    7.605315         -5         95
     hgc2005 |      8,984    9.738313    7.793018         -5         95
     hgc2006 |      8,984    10.28128    7.374481         -5         95
-------------+---------------------------------------------------------
     hgc2007 |      8,984     10.0423    7.492933         -5         95
     hgc2008 |      8,984   -.2122663    7.963013         -5         95
     hgc2009 |      8,984   -.3427204    8.139356         -5         95
     hgc2010 |      8,984   -.4436776    8.451876         -5         95
     hgc2011 |      8,984   -.9385574    7.438404         -5         95
-------------+---------------------------------------------------------
tenurew~1997 |      8,984    5.352961    30.48266         -4        554
tenurew~1998 |      8,984    13.88936    37.55114         -5        620
tenurew~1999 |      8,984    19.00045     42.2373         -5        679
tenurew~2000 |      8,984    26.20848    45.12096         -5        645
tenurew~2001 |      8,984    33.28072    51.62314         -5        612
-------------+---------------------------------------------------------
tenurew~2002 |      8,984     40.7923    59.96237         -5        661
tenurew~2003 |      8,984    46.32992    68.38933         -5        712
tenurew~2004 |      8,984     52.5059    75.84838         -5        760
tenurew~2005 |      8,984    57.46238    84.09562         -5        808
tenurew~2006 |      8,984    67.16474      93.158         -5        864
-------------+---------------------------------------------------------
tenurew~2007 |      8,984    73.22618    101.7454         -5        909
tenurew~2008 |      8,984    85.22896    112.3534         -5        960
tenurew~2009 |      8,984    96.26992    124.7585         -5       1008
tenurew~2010 |      8,984    105.4566    138.0999         -5       1065
tenurew~2011 |      8,984    111.8733     149.369         -5       1113
-------------+---------------------------------------------------------
intmonth1997 |      8,984    4.353295    1.648394          1          9
intmonth1998 |      8,984     6.67598    5.510091         -5         12
intmonth1999 |      8,984    7.187444    5.752032         -5         12
intmonth2000 |      8,984    4.838379    5.671391         -5         12
intmonth2001 |      8,984    5.093166    6.000881         -5         12
-------------+---------------------------------------------------------
intmonth2002 |      8,984    5.256679    6.015769         -5         12
intmonth2003 |      8,984    6.383126    6.164155         -5         12
intmonth2004 |      8,984    5.276269    6.342644         -5         12
intmonth2005 |      8,984    5.873553    6.593173         -5         12
intmonth2006 |      8,984    6.516251    6.326171         -5         12
-------------+---------------------------------------------------------
intmonth2007 |      8,984    6.906389    6.218178         -5         12
intmonth2008 |      8,984    6.606857    6.195679         -5         12
intmonth2009 |      8,984    7.048753    5.784438         -5         12
intmonth2010 |      8,984    6.807324    6.270654         -5         12
intmonth2011 |      8,984    6.871327     5.83707         -5         12
-------------+---------------------------------------------------------
   hrp1_1997 |      8,984    121.3256     270.715         -4       5000
   hrp1_1998 |      8,984    283.1752    437.8017         -5      19500
   hrp1_1999 |      8,984    397.4308    1126.587         -5      80000
   hrp1_2000 |      8,984    672.0748    8622.758         -5     720000
   hrp1_2001 |      8,984    609.1001    1307.964         -5      60000
-------------+---------------------------------------------------------
   hrp1_2002 |      8,984    817.1035     5581.25         -5     270000
   hrp1_2003 |      8,984     829.667     4169.97         -5     280000
   hrp1_2004 |      8,984    930.4009    4343.668         -5     300000
   hrp1_2005 |      8,984    1003.705    5847.066         -5     300000
   hrp1_2006 |      8,984    1508.117    32682.28         -5    3000000
-------------+---------------------------------------------------------
   hrp1_2007 |      8,984    1457.435    31826.89         -5    3000000
   hrp1_2008 |      8,984    1548.922    31800.15         -5    3000000
   hrp1_2009 |      8,984    2345.849     95883.6         -5    9000000
   hrp1_2010 |      8,984    1347.474    8081.126         -5     600000
   hrp1_2011 |      8,984    1335.188    4654.517         -5     288000

. summ sex bdate* race_eth

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         sex |      8,984     1.48809     .499886          1          2
 bdate_month |      8,984    6.555988    3.469429          1         12
  bdate_year |      8,984     1982.01     1.39687       1980       1984
    race_eth |      8,984    2.787845    1.313645          1          4

. 
. *** Merge in custom weights for using sample of people in years 1979-1994
. sort pubid

. merge 1:1 pubid using custwt_1997to2011.dta

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                             8,984  (_merge==3)
    -----------------------------------------

. drop _merge

. 
. summ custwt

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
      custwt |      8,984    215699.6    93100.95      76071    1576182

. 
. *** Basic Mincer controls
. 
. gen black=(race_eth==1)

. gen hisp=(race_eth==2)

. 
. gen female=(sex==2)

. 
. summ black hisp female

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       black |      8,984    .2599065    .4386075          0          1
        hisp |      8,984    .2115984    .4084643          0          1
      female |      8,984    .4880899     .499886          0          1

. 
. foreach x of numlist 1997/2011 {
  2.   gen age`x'=.
  3.   replace age`x'= (`x' - bdate_year)
  4.   replace age`x' = age`x' - 1 if (bdate_month > intmonth`x') 
  5.   replace age`x'=. if intmonth`x' < 0
  6. }
(8,984 missing values generated)
(8,984 real changes made)
(5,794 real changes made)
(0 real changes made)
(8,984 missing values generated)
(8,984 real changes made)
(3,730 real changes made)
(598 real changes made, 598 to missing)
(8,984 missing values generated)
(8,984 real changes made)
(3,296 real changes made)
(776 real changes made, 776 to missing)
(8,984 missing values generated)
(8,984 real changes made)
(4,960 real changes made)
(904 real changes made, 904 to missing)
(8,984 missing values generated)
(8,984 real changes made)
(4,714 real changes made)
(1,102 real changes made, 1,102 to missing)
(8,984 missing values generated)
(8,984 real changes made)
(4,548 real changes made)
(1,088 real changes made, 1,088 to missing)
(8,984 missing values generated)
(8,984 real changes made)
(3,678 real changes made)
(1,230 real changes made, 1,230 to missing)
(8,984 missing values generated)
(8,984 real changes made)
(4,441 real changes made)
(1,482 real changes made, 1,482 to missing)
(8,984 missing values generated)
(8,984 real changes made)
(3,905 real changes made)
(1,646 real changes made, 1,646 to missing)
(8,984 missing values generated)
(8,984 real changes made)
(3,513 real changes made)
(1,425 real changes made, 1,425 to missing)
(8,984 missing values generated)
(8,984 real changes made)
(3,137 real changes made)
(1,566 real changes made, 1,566 to missing)
(8,984 missing values generated)
(8,984 real changes made)
(3,398 real changes made)
(1,494 real changes made, 1,494 to missing)
(8,984 missing values generated)
(8,984 real changes made)
(3,109 real changes made)
(1,425 real changes made, 1,425 to missing)
(8,984 missing values generated)
(8,984 real changes made)
(3,227 real changes made)
(1,505 real changes made, 1,505 to missing)
(8,984 missing values generated)
(8,984 real changes made)
(3,195 real changes made)
(1,561 real changes made, 1,561 to missing)

. 
. summ age*

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     age1997 |      8,984    14.34472     1.47763         12         17
     age1998 |      8,386    15.59504    1.452518         13         18
     age1999 |      8,208    16.64327    1.427826         14         19
     age2000 |      8,080      17.437     1.44931         15         20
     age2001 |      7,882    18.47666    1.438949         16         21
-------------+---------------------------------------------------------
     age2002 |      7,896        19.5    1.474461         17         22
     age2003 |      7,754    20.62922    1.453835         18         23
     age2004 |      7,502    21.55292    1.465348         19         24
     age2005 |      7,338     22.6375    1.458889         20         25
     age2006 |      7,559    23.67694    1.452297         21         26
-------------+---------------------------------------------------------
     age2007 |      7,418    24.74252    1.444315         22         27
     age2008 |      7,490    25.70908    1.452368         23         28
     age2009 |      7,559    26.74653    1.451717         24         29
     age2010 |      7,479    27.73232    1.444993         25         30
     age2011 |      7,423    28.74148    1.447868         26         31

. 
. foreach x of numlist 1997/2011 {
  2.   qui gen married`x'=.
  3.   qui replace married`x'=1 if marstat`x'>=3 & marstat`x'<=6 
  4.   qui replace married`x'=0 if marstat`x'==1 | marstat`x'==2 | marstat`x'==7 | marstat`x'==8 | marstat`x'==9 | marstat`x'==10
  5.   
.   qui replace region`x'=. if region`x' < 0
  6.   
.   qui replace smsares`x'=. if smsares`x' < 0 | smsares`x'==5
  7.   qui replace smsares`x'=0 if smsares`x'==1
  8.   qui replace smsares`x'=1 if smsares`x' > 1 & smsares`x'~=.
  9. }  

. 
. summ married* region* smsares*

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
 married1997 |      1,672    .0023923    .0488677          0          1
 married1998 |      3,274    .0134392    .1151636          0          1
 married1999 |      4,846    .0233182    .1509277          0          1
 married2000 |      6,413    .0364884    .1875166          0          1
 married2001 |      7,875    .0554921    .2289527          0          1
-------------+---------------------------------------------------------
 married2002 |      7,894    .0793007    .2702247          0          1
 married2003 |      7,749    .1126597    .3161968          0          1
 married2004 |      7,493    .1508074    .3578849          0          1
 married2005 |      7,329    .1881566    .3908639          0          1
 married2006 |      7,548    .2256227    .4180194          0          1
-------------+---------------------------------------------------------
 married2007 |      7,406    .2589792    .4381037          0          1
 married2008 |      7,472    .2904176    .4539854          0          1
 married2009 |      7,544    .3210498    .4669108          0          1
 married2010 |      7,464    .3496785    .4769003          0          1
 married2011 |      7,400    .3732432    .4836986          0          1
-------------+---------------------------------------------------------
  region1997 |      8,984    2.640472    1.013036          1          4
  region1998 |      8,360    2.646053    1.008735          1          4
  region1999 |      8,188    2.657181    1.008012          1          4
  region2000 |      8,045     2.65867    1.010063          1          4
  region2001 |      7,844    2.663947    1.007568          1          4
-------------+---------------------------------------------------------
  region2002 |      7,842    2.659398    1.003708          1          4
  region2003 |      7,714    2.664247    .9982741          1          4
  region2004 |      7,463    2.678012    .9971322          1          4
  region2005 |      7,303    2.681501    .9947253          1          4
  region2006 |      7,515    2.693413    .9902119          1          4
-------------+---------------------------------------------------------
  region2007 |      7,362    2.705651    .9850909          1          4
  region2008 |      7,433    2.704023    .9876014          1          4
  region2009 |      7,510    2.709321    .9856101          1          4
  region2010 |      7,422    2.706818    .9863668          1          4
  region2011 |      7,357    2.712791    .9859071          1          4
-------------+---------------------------------------------------------
 smsares1997 |      8,984    .8243544    .3805395          0          1
 smsares1998 |      8,352    .8200431    .3841745          0          1
 smsares1999 |      8,180    .8227384    .3819133          0          1
 smsares2000 |      8,036    .8189398     .385092          0          1
 smsares2001 |      7,821    .8209948    .3833812          0          1
-------------+---------------------------------------------------------
 smsares2002 |      7,825    .8245367    .3803872          0          1
 smsares2003 |      7,709    .8301985    .3754827          0          1
 smsares2004 |      7,463    .9658314    .1816741          0          1
 smsares2005 |      7,280    .9543956    .2086399          0          1
 smsares2006 |      7,502    .9549453    .2074379          0          1
-------------+---------------------------------------------------------
 smsares2007 |      7,362    .9542244    .2090123          0          1
 smsares2008 |      7,423    .9594504    .1972577          0          1
 smsares2009 |      7,499    .9603947     .195043          0          1
 smsares2010 |      7,415    .9552259    .2068216          0          1
 smsares2011 |      7,347    .9560365    .2050279          0          1

. 
. foreach x of numlist 1997/1997 {
  2.   gen edgrp4_`x'=.
  3.   qui replace edgrp4_`x'=1 if hgc`x' < 12 & hgc`x' > 0
  4.   qui replace edgrp4_`x'=2 if hgc`x' == 12  
  5.   qui replace edgrp4_`x'=3 if hgc`x' >= 13 & hgc`x' <= 15
  6.   qui replace edgrp4_`x'=4 if hgc`x' >= 16
  7.   qui replace edgrp4_`x'=. if hgc`x' < 0 | hgc`x' > 20
  8. }    
(8,984 missing values generated)

. 
. foreach x of numlist 1998/2011 {
  2.   local y = `x' - 1
  3.   qui gen edgrp4_`x'=.
  4.   qui replace edgrp4_`x'=1 if hgc`x' < 12 & hgc`x' > 0
  5.   qui replace edgrp4_`x'=2 if hgc`x' == 12  
  6.   qui replace edgrp4_`x'=3 if hgc`x' >= 13 & hgc`x' <= 15
  7.   qui replace edgrp4_`x'=4 if hgc`x' >= 16 & hgc`x' <= 20
  8.   qui replace edgrp4_`x'=edgrp4_`y' if hgc`x' < 0
  9. }    

. 
. summ edgrp4_* hgc*

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
 edgrp4_1997 |      8,975     1.00156    .0394668          1          2
 edgrp4_1998 |      8,978    1.084317    .2873385          1          3
 edgrp4_1999 |      8,978    1.268657    .5354743          1          3
 edgrp4_2000 |      8,973     1.49727    .7045156          1          4
 edgrp4_2001 |      8,970    1.744928    .7914693          1          4
-------------+---------------------------------------------------------
 edgrp4_2002 |      8,963    2.023095    .8297511          1          4
 edgrp4_2003 |      8,965    2.213162    .8900791          1          4
 edgrp4_2004 |      8,964     2.31158    .9463317          1          4
 edgrp4_2005 |      8,966    2.381887    .9975105          1          4
 edgrp4_2006 |      8,972    2.454637    1.042329          1          4
-------------+---------------------------------------------------------
 edgrp4_2007 |      8,975    2.490474    1.066171          1          4
 edgrp4_2008 |      8,973    2.520116    1.076313          1          4
 edgrp4_2009 |      8,967    2.546671    1.080221          1          4
 edgrp4_2010 |      8,960    2.579129    1.084338          1          4
 edgrp4_2011 |      8,964    2.594824    1.086281          1          4
-------------+---------------------------------------------------------
     hgc1997 |      8,984    7.703362    1.600695         -4         12
     hgc1998 |      8,984    8.400267     4.07454         -5         95
     hgc1999 |      8,984    8.920191    4.773622         -5         95
     hgc2000 |      8,984    9.390583    5.471028         -5         95
     hgc2001 |      8,984     9.63947    6.250559         -5         95
-------------+---------------------------------------------------------
     hgc2002 |      8,984    10.17787    6.699725         -5         95
     hgc2003 |      8,984    10.18455    6.988198         -5         95
     hgc2004 |      8,984    9.926981    7.605315         -5         95
     hgc2005 |      8,984    9.738313    7.793018         -5         95
     hgc2006 |      8,984    10.28128    7.374481         -5         95
-------------+---------------------------------------------------------
     hgc2007 |      8,984     10.0423    7.492933         -5         95
     hgc2008 |      8,984   -.2122663    7.963013         -5         95
     hgc2009 |      8,984   -.3427204    8.139356         -5         95
     hgc2010 |      8,984   -.4436776    8.451876         -5         95
     hgc2011 |      8,984   -.9385574    7.438404         -5         95

. 
. 
. *** Job tenure is calculated in weeks for each job in NLSY97
. *** Job gaps excluded
. foreach x of numlist 1997/2011 {
  2.    gen tenuremon1_`x' = tenureweeks1_`x' / 4.333 if tenureweeks1_`x' > 0
  3. }
(6,765 missing values generated)
(4,624 missing values generated)
(3,639 missing values generated)
(2,679 missing values generated)
(2,521 missing values generated)
(2,412 missing values generated)
(2,522 missing values generated)
(2,597 missing values generated)
(2,664 missing values generated)
(2,364 missing values generated)
(2,492 missing values generated)
(2,450 missing values generated)
(2,637 missing values generated)
(2,855 missing values generated)
(2,933 missing values generated)

. 
. summ tenuremon1_*

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
tenurem~1997 |      2,219    7.808796    11.95956    .230787    127.856
tenurem~1998 |      4,360    7.613641    10.81693    .230787   143.0879
tenurem~1999 |      5,345    8.028537     11.2666    .230787   156.7044
tenurem~2000 |      6,305    9.039785    11.15811    .230787   148.8576
tenurem~2001 |      6,463    11.07181    12.50299    .230787   141.2416
-------------+---------------------------------------------------------
tenurem~2002 |      6,572    13.24223    14.39471    .230787   152.5502
tenurem~2003 |      6,462    15.26444    16.48848    .230787   164.3203
tenurem~2004 |      6,387    17.47018     18.2181    .230787   175.3981
tenurem~2005 |      6,320    19.29741    20.31237    .230787   186.4759
tenurem~2006 |      6,620     21.4126    22.23682    .230787   199.3999
-------------+---------------------------------------------------------
tenurem~2007 |      6,492    23.79342    24.32492    .230787   209.7854
tenurem~2008 |      6,534    27.43977    26.51541    .230787   221.5555
tenurem~2009 |      6,347    31.87998      29.247    .230787   232.6333
tenurem~2010 |      6,129    36.15731    32.39428    .230787   245.7881
tenurem~2011 |      6,051    38.83652     35.2887    .230787   256.8659

. 
. *** Highest grade completed
. *XXXX
. 
. *** ASVAB scores available in NLSY97 - need to figure out how to use these
. *XXXX
. 
. *** BLS created hourly rate of pay for each job, extreme values need to be trimmed
. *** Merge in cpi for deflating hourly wages 
. 
. preserve

. clear

. 
. use cpiu_8284

. drop if year < 1997 | year > 2011
(38 observations deleted)

. rename cpiu_8284 cpiu_8284_

. gen id=1

. reshape wide cpiu_8284_, i(id) j(year)
(note: j = 1997 1998 1999 2000 2001 2002 2003 2004 2005 2006 2007 2008 2009 2010 2011)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       15   ->       1
Number of variables                   3   ->      16
j variable (15 values)             year   ->   (dropped)
xij variables:
                             cpiu_8284_   ->   cpiu_8284_1997 cpiu_8284_1998 ... cpiu_8284_2011
-----------------------------------------------------------------------------

. tempfile tempcpi

. save `tempcpi', replace
(note: file C:\Users\awaggone\AppData\Local\Temp\ST_08000002.tmp not found)
file C:\Users\awaggone\AppData\Local\Temp\ST_08000002.tmp saved

. clear

. 
. restore 

. 
. gen id=1

. merge m:1 id using `tempcpi'

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                             8,984  (_merge==3)
    -----------------------------------------

. drop _merge

. summ cpiu*

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
cpiu_82~1997 |      8,984       160.5           0      160.5      160.5
cpiu_82~1998 |      8,984         163           0        163        163
cpiu_82~1999 |      8,984       166.6           0      166.6      166.6
cpiu_82~2000 |      8,984       172.2           0      172.2      172.2
cpiu_82~2001 |      8,984       177.1           0      177.1      177.1
-------------+---------------------------------------------------------
cpiu_82~2002 |      8,984       179.9           0      179.9      179.9
cpiu_82~2003 |      8,984         184           0        184        184
cpiu_82~2004 |      8,984       188.9           0      188.9      188.9
cpiu_82~2005 |      8,984       195.3           0      195.3      195.3
cpiu_82~2006 |      8,984       201.6           0      201.6      201.6
-------------+---------------------------------------------------------
cpiu_82~2007 |      8,984     207.342           0    207.342    207.342
cpiu_82~2008 |      8,984     215.303           0    215.303    215.303
cpiu_82~2009 |      8,984     214.537           0    214.537    214.537
cpiu_82~2010 |      8,984     218.056           0    218.056    218.056
cpiu_82~2011 |      8,984     224.939           0    224.939    224.939

. 
. foreach x of numlist 1997/2011 {
  2.   gen rhrp1_`x'=.
  3.   replace rhrp1_`x' = hrp1_`x' / cpiu_8284_`x' if hrp1_`x' > 0
  4.   }
(8,984 missing values generated)
(2,114 real changes made)
(8,984 missing values generated)
(4,252 real changes made)
(8,984 missing values generated)
(5,312 real changes made)
(8,984 missing values generated)
(6,265 real changes made)
(8,984 missing values generated)
(6,390 real changes made)
(8,984 missing values generated)
(6,497 real changes made)
(8,984 missing values generated)
(6,399 real changes made)
(8,984 missing values generated)
(6,254 real changes made)
(8,984 missing values generated)
(6,160 real changes made)
(8,984 missing values generated)
(6,482 real changes made)
(8,984 missing values generated)
(6,363 real changes made)
(8,984 missing values generated)
(6,391 real changes made)
(8,984 missing values generated)
(6,212 real changes made)
(8,984 missing values generated)
(5,995 real changes made)
(8,984 missing values generated)
(5,934 real changes made)

. 
. summ rhrp1* hrp1* 

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  rhrp1_1997 |      2,114    3.292626    1.917231   .0186916   31.15265
  rhrp1_1998 |      4,252    3.698343    2.818005    .006135   119.6319
  rhrp1_1999 |      5,312    4.051709    8.399421   .0180072    480.192
  rhrp1_2000 |      6,265    5.607243    59.88491   .0058072   4181.185
  rhrp1_2001 |      6,390     4.84526     8.35724   .0112931   338.7916
-------------+---------------------------------------------------------
  rhrp1_2002 |      6,497    6.289758    36.33122   .0055586   1500.834
  rhrp1_2003 |      6,399    6.340086     26.6358   .0108696   1521.739
  rhrp1_2004 |      6,254    7.085573    27.28069   .0052938   1588.142
  rhrp1_2005 |      6,160    7.505802    35.90965   .0051203   1536.098
  rhrp1_2006 |      6,482    10.37668    190.7796   .0049603   14880.95
-------------+---------------------------------------------------------
  rhrp1_2007 |      6,363    9.933368     182.319   .0048229   14468.85
  rhrp1_2008 |      6,391     10.1213    175.0367   .0046446   13933.85
  rhrp1_2009 |      6,212    15.82284      537.42   .0046612    41950.8
  rhrp1_2010 |      5,995    9.270394    45.05105    .009172   2751.587
  rhrp1_2011 |      5,934    8.996678    24.91354   .0044456   1280.347
-------------+---------------------------------------------------------
   hrp1_1997 |      8,984    121.3256     270.715         -4       5000
   hrp1_1998 |      8,984    283.1752    437.8017         -5      19500
   hrp1_1999 |      8,984    397.4308    1126.587         -5      80000
   hrp1_2000 |      8,984    672.0748    8622.758         -5     720000
   hrp1_2001 |      8,984    609.1001    1307.964         -5      60000
-------------+---------------------------------------------------------
   hrp1_2002 |      8,984    817.1035     5581.25         -5     270000
   hrp1_2003 |      8,984     829.667     4169.97         -5     280000
   hrp1_2004 |      8,984    930.4009    4343.668         -5     300000
   hrp1_2005 |      8,984    1003.705    5847.066         -5     300000
   hrp1_2006 |      8,984    1508.117    32682.28         -5    3000000
-------------+---------------------------------------------------------
   hrp1_2007 |      8,984    1457.435    31826.89         -5    3000000
   hrp1_2008 |      8,984    1548.922    31800.15         -5    3000000
   hrp1_2009 |      8,984    2345.849     95883.6         -5    9000000
   hrp1_2010 |      8,984    1347.474    8081.126         -5     600000
   hrp1_2011 |      8,984    1335.188    4654.517         -5     288000

. 
. foreach x of numlist 1997/2011 {
  2.   egen templo=pctile(rhrp1_`x'), p(2.5)
  3.   egen temphi=pctile(rhrp1_`x'), p(97.5)
  4.   replace rhrp1_`x'=. if (rhrp1_`x' > temphi | rhrp1_`x' < templo)
  5.   drop temphi templo
  6. }
(101 real changes made, 101 to missing)
(208 real changes made, 208 to missing)
(254 real changes made, 254 to missing)
(304 real changes made, 304 to missing)
(316 real changes made, 316 to missing)
(259 real changes made, 259 to missing)
(255 real changes made, 255 to missing)
(301 real changes made, 301 to missing)
(302 real changes made, 302 to missing)
(318 real changes made, 318 to missing)
(318 real changes made, 318 to missing)
(314 real changes made, 314 to missing)
(305 real changes made, 305 to missing)
(284 real changes made, 284 to missing)
(291 real changes made, 291 to missing)

. 
. summ rhrp1*

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  rhrp1_1997 |      2,013    3.136309    .8845428   .6542056   7.476635
  rhrp1_1998 |      4,044    3.528085    .7786189   1.226994   6.748466
  rhrp1_1999 |      5,058    3.753825    .8608835     1.5006   7.202881
  rhrp1_2000 |      5,961    4.042312    1.120311     1.4518   8.710801
  rhrp1_2001 |      6,074     4.22849    1.301618   1.230943   10.16375
-------------+---------------------------------------------------------
  rhrp1_2002 |      6,238    4.472974    1.569135   1.183991   11.63424
  rhrp1_2003 |      6,144    4.799086    1.890273   1.157609   13.58696
  rhrp1_2004 |      5,953    5.186193    2.207914   1.138168   16.94018
  rhrp1_2005 |      5,858    5.547481    2.449824   1.280082    17.8597
  rhrp1_2006 |      6,164    5.859703    2.594652    1.40377   17.49008
-------------+---------------------------------------------------------
  rhrp1_2007 |      6,045    6.322556    2.867243   1.495114   18.32721
  rhrp1_2008 |      6,077    6.573766    3.158107   1.453765   21.17017
  rhrp1_2009 |      5,907    6.802729    3.190348   1.458956   19.05033
  rhrp1_2010 |      5,711    7.182182    3.644534     1.7335   22.92989
  rhrp1_2011 |      5,643    7.284695    3.723183   2.222825   23.70865

. 
. /*** Not sure why but some of the emp_status arrays seem to be missing, prior to 1999, on Investigator. Commenting out for now. ***/
. 
. /***
> 
> *** Create variables comparable to weeks unemployed last year (PCY) to that from 79 data - also count up weeks of active service ;
> 
> foreach x of numlist 1997/2011 {
>    gen wksuemp_pcy`x'=.
>    gen wksactive`x'=.
>    local y = `x' - 1
>       foreach z of numlist 1/52 {
>       replace wksuemp_pcy`x'=1 if wksuemp_pcy`x'==. & EMP_STATUS_`y'_`z'==4
>       replace wksuemp_pcy`x'= (wksuemp_pcy`x' + 1) if wksuemp_pcy`x'~=. & EMP_STATUS_`y'_`z'==4
>       replace wksactive`x'=1 if wksactive`x'==. & EMP_STATUS_`y'_`z'==6
>       replace wksactive`x'= (wksactive`x' + 1) if wksactive`x'~=. & EMP_STATUS_`y'_`z'==6
>    }
> }
> 
> foreach x of numlist 1996 {
>    gen wkswkann`x'=.
>       foreach z of numlist 1/52 {
>       replace wkswkann`x'=1 if wkswkann`x'==. & EMP_STATUS_`x'_`z' > 100
>       replace wkswkann`x'= (wkswkann`x' + 1) if wkswkann`x'~=. & EMP_STATUS_`x'_`z' > 100
>    }
> }
> summ wksuemp* wksactive* wkswkann*
> 
> *save nlsy97_1997to2011_empstatus.dta, replace
> 
> ***/
. 
. drop EMP_STATUS*

.       
. quietly compress

. 
. save nlsy97_1997to2011.dta, replace
file nlsy97_1997to2011.dta saved

. 
. log close
      name:  <unnamed>
       log:  C:\Users\awaggone\Dropbox\Job tenure\NLS and NLSY data\NLSY97\Data construction\makedata_nlsy97.log
  log type:  text
 closed on:  12 Mar 2019, 16:01:16
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
